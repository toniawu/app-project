(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-list-list"],{"0b05":function(t,e,n){"use strict";n.r(e);var a=n("bcda"),i=n.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(o);e["default"]=i.a},2878:function(t,e,n){var a=n("b7a7");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var i=n("967d").default;i("0ef37ffa",a,!0,{sourceMap:!1,shadowMode:!1})},"29a7":function(t,e,n){"use strict";n.r(e);var a=n("4663"),i=n.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(o);e["default"]=i.a},4663:function(t,e,n){"use strict";(function(t){n("6a54");var a=n("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("bf0f"),n("2797"),n("aa9c"),n("fd3c"),n("3efd"),n("d4b5");var i,o=a(n("b7c7")),r=a(n("9b1b")),s=a(n("2634")),u=a(n("2fdc")),c=a(n("60f6")),d=a(n("eb98")),l=(new d.default,t.database()),f={onLoad:function(){this.videoOff(),this.score=uni.getStorageSync("score"),console.log("分数："+this.score)},components:{statusBar:c.default},computed:{inputPlaceholder:function(t){return"en"==uni.getStorageSync("CURRENT_LANG")?"Please enter the search content":"请输入搜索内容"},colList:function(){return[l.collection("opendb-news-articles").where(this.where).field("avatar,title,last_modify_date,user_id").getTemp(),l.collection("uni-id-users").field("_id,nickname").getTemp()]}},data:function(){return{videobool:2,score:0,where:'"article_status" == 1',keyword:"",showRefresh:!1,listHight:0,videoList:[]}},watch:{keyword:function(t,e){var n='"article_status" == 1 ';this.where=t?n+"&& /".concat(t,"/.test(title)"):n}},onReady:function(){var t=this;return(0,u.default)((0,s.default)().mark((function e(){return(0,s.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.listHight="auto",i=t.$refs.udb;case 2:case"end":return e.stop()}}),e)})))()},onShow:function(){var t=this;return(0,u.default)((0,s.default)().mark((function e(){return(0,s.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.getAllVideo(),t.getNewVideoList(),t.keyword=getApp().globalData.searchText,getApp().globalData.searchText="";case 4:case"end":return e.stop()}}),e)})))()},methods:{videoOff:function(){var t=this;uni.request({url:"https://fc-mp-f02adfe0-c2b7-4979-95b9-97f95913e417.next.bspapp.com/banner/videoOff"}).then((function(e){t.videobool=e[1].data}))},sendPushMessage:function(){var t=uni.getStorageSync("uni-id-pages-userInfo"),e=t._id;console.log(e),uni.request({url:"https://fc-mp-f02adfe0-c2b7-4979-95b9-97f95913e417.next.bspapp.com/banner/pushMessage",method:"POST",data:{uid:e}}).then((function(t){}))},getAllVideo:function(){var t=this,e=uni.getStorageSync("uni-id-pages-userInfo"),n=e._id;console.log(n),uni.request({url:"https://fc-mp-f02adfe0-c2b7-4979-95b9-97f95913e417.next.bspapp.com/push/getSurveysId",method:"POST",data:{uid:n},success:function(e){console.log(e),""!=e.data&&uni.request({url:"https://fc-mp-f02adfe0-c2b7-4979-95b9-97f95913e417.next.bspapp.com/push/getAllVideoList",method:"GET",data:{uid:n,category_id:e.data},success:function(e){var n,a=e.data.data,i=[];a.forEach((function(e){if(e.start_score||i.push(e),0!=e.number){var n=e.number/e.count*100;n<95&&t.sendPushMessage()}else t.sendPushMessage();console.log(e)}));var s=i.map((function(t){var e=(0,r.default)((0,r.default)({},t),{},{url:t.videofile.url});return delete e.videofile,e}));t.videoList=[],(n=t.videoList).unshift.apply(n,(0,o.default)(s))}})}})},getNewVideoList:function(){var t=this,e=uni.getStorageSync("uni-id-pages-userInfo"),n=e._id;uni.request({url:"https://fc-mp-f02adfe0-c2b7-4979-95b9-97f95913e417.next.bspapp.com/push/processPush",method:"GET",data:{id:n},success:function(e){var n=e.data.data;if(0!=n.length){var a=n.map((function(t){var e=(0,r.default)((0,r.default)({},t),{},{url:t.videofile.url});return delete e.videofile,e}));console.log("规则推送视频列表："+JSON.stringify(a)),t.videoList.unshift(a[0]),console.log("视频列表："+JSON.stringify(t.videoList))}}})},getPushMsg:function(){var t=this;console.log("获取视频列表"),uni.request({url:"https://fc-mp-f02adfe0-c2b7-4979-95b9-97f95913e417.next.bspapp.com/push/pushVideo",method:"GET",success:function(e){var n=e.data.data;if(0!=n.length){var a=n.map((function(t){var e=(0,r.default)((0,r.default)({},t),{},{url:t.videofile.url});return delete e.videofile,e}));console.log("规则推送视频列表："+JSON.stringify(a)),t.videoList.unshift(a[0]),console.log("视频列表："+JSON.stringify(t.videoList))}}})},videoPlay:function(){console.log("视频开始播放")},videoPause:function(){console.log("视频暂停播放")},videoEnded:function(){console.log("视频播放完毕")},videoVolumeChange:function(t){console.log("音量改变："+t.detail.value)},getScore:function(){this.score=uni.getStorageSync("score"),console.log("分数："+this.score),this.addList(this.score)},searchClick:function(t){uni.hideKeyboard(),uni.navigateTo({url:"/pages/list/search/search",animationType:"fade-in"})},retry:function(){this.refresh()},refresh:function(){i.loadData({clear:!0},(function(){uni.stopPullDownRefresh(),console.log("end")})),console.log("refresh")},loadMore:function(){i.loadMore()},onqueryerror:function(t){console.error(t)},onpullingdown:function(t){console.log(t),this.showRefresh=!0,t.pullingDistance>100&&this.refresh()}},onPullDownRefresh:function(){this.refresh()},onReachBottom:function(){this.loadMore()}};e.default=f}).call(this,n("861b")["default"])},"4e6f":function(t,e,n){"use strict";var a=n("a42b"),i=n.n(a);i.a},"60f6":function(t,e,n){"use strict";n.r(e);var a=n("f403"),i=n("0b05");for(var o in i)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(o);n("4e6f");var r=n("828b"),s=Object(r["a"])(i["default"],a["b"],a["c"],!1,null,"301962e0",null,!1,a["a"],void 0);e["default"]=s.exports},9032:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return a}));var a={unicloudDb:n("3220").default,uniList:n("f782").default,uniListItem:n("215b").default,uniDateformat:n("e7fb").default,uniLoadState:n("1e4a").default},i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"pages"},[1==t.videobool?n("unicloud-db",{ref:"udb",attrs:{collection:t.colList,"page-size":10},on:{error:function(e){arguments[0]=e=t.$handleEvent(e),t.onqueryerror.apply(void 0,arguments)}},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.data,i=e.pagination,o=e.hasMore,r=e.loading,s=e.error;e.options;return[n("uni-list",{staticClass:"uni-list",style:{height:t.listHight},attrs:{border:!1}},[t._l(t.videoList,(function(e,a){return n("uni-list-item",{key:a,attrs:{to:"/pages/list/detail?id="+e._id+"&title="+e.title},scopedSlots:t._u([{key:"header",fn:function(){return[n("v-uni-image",{staticClass:"avatar",attrs:{src:e.cover.url,mode:"aspectFill"}})]},proxy:!0},{key:"body",fn:function(){return[n("v-uni-view",{staticClass:"main"},[n("v-uni-text",{staticClass:"title"},[t._v(t._s(e.title))]),n("v-uni-view",{staticClass:"info"},[n("uni-dateformat",{staticClass:"last_modify_date",attrs:{date:e._creatTime,format:"yyyy-MM-dd",threshold:[6e4,2592e6]}}),0==e.number?n("v-uni-text",{staticClass:"last_modify_date",staticStyle:{"text-align":"right"}},[t._v("暂未观看")]):t._e(),e.number>0&&e.number<e.count?n("v-uni-text",{staticClass:"last_modify_date"},[t._v("已完成"+t._s(e.percentage))]):t._e(),e.number==e.count?n("v-uni-text",{staticClass:"last_modify_date"},[t._v("已完成观看")]):t._e()],1)],1)]},proxy:!0}],null,!0)})})),n("uni-load-state",{attrs:{state:{data:a,pagination:i,hasMore:o,loading:r,error:s}},on:{networkResume:function(e){arguments[0]=e=t.$handleEvent(e),t.refresh.apply(void 0,arguments)},loadMore:function(e){arguments[0]=e=t.$handleEvent(e),t.loadMore.apply(void 0,arguments)}}})],2)]}}],null,!1,1887133692)}):t._e(),2==t.videobool?n("v-uni-view",{staticClass:"news",attrs:{class:"news"}},[n("v-uni-view",{staticClass:"newstitle"},[t._v("新闻咨询")])],1):t._e()],1)},o=[]},9602:function(t,e,n){"use strict";var a=n("2878"),i=n.n(a);i.a},a42b:function(t,e,n){var a=n("b7fc");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var i=n("967d").default;i("4894fc25",a,!0,{sourceMap:!1,shadowMode:!1})},af43:function(t,e,n){"use strict";n.r(e);var a=n("9032"),i=n("29a7");for(var o in i)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(o);n("9602");var r=n("828b"),s=Object(r["a"])(i["default"],a["b"],a["c"],!1,null,"ad22a776",null,!1,a["a"],void 0);e["default"]=s.exports},b7a7:function(t,e,n){var a=n("c86c");e=a(!1),e.push([t.i,".news[data-v-ad22a776]{width:80%;margin:0 auto}.newstitle[data-v-ad22a776]{text-align:center;font-size:%?50?%}.newslist[data-v-ad22a776]{width:100%;height:%?200?%;margin-top:%?30?%}\nuni-view[data-v-ad22a776]{display:flex;box-sizing:border-box;flex-direction:column}\n.pages[data-v-ad22a776]{background-color:#fff;padding-top:%?60?%}.avatar[data-v-ad22a776]{width:%?200?%;height:%?200?%;margin-right:%?10?%}.main[data-v-ad22a776]{justify-content:space-between;flex:1}.title[data-v-ad22a776]{font-size:16px}.info[data-v-ad22a776]{flex-direction:row;justify-content:space-between}.author[data-v-ad22a776],\n.last_modify_date[data-v-ad22a776]{font-size:14px;color:#999}.uni-search-box[data-v-ad22a776]{background-color:#fff;position:-webkit-sticky;position:sticky;height:50px;top:0;left:0;\nz-index:9;\n}.cover-search-bar[data-v-ad22a776]{height:50px;position:relative;top:-50px;margin-bottom:-50px;\nz-index:999\n}",""]),t.exports=e},b7fc:function(t,e,n){var a=n("c86c");e=a(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.uni-status-bar[data-v-301962e0]{height:20px}',""]),t.exports=e},bcda:function(t,e,n){"use strict";n("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={name:"UniStatusBar",data:function(){return{statusBarHeight:uni.getSystemInfoSync().statusBarHeight+"px"}}};e.default=a},eb98:function(t,e,n){"use strict";n("6a54");var a=n("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("bf0f");var i=a(n("2634")),o=a(n("9b1b")),r=a(n("2fdc")),s=a(n("80b1")),u=a(n("efe5")),c=function(){function t(e){(0,s.default)(this,t),this.lock=!1}return(0,u.default)(t,[{key:"getLocation",value:function(){var t=(0,r.default)((0,i.default)().mark((function t(){var e,n=this,a=arguments;return(0,i.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=a.length>0&&void 0!==a[0]?a[0]:{type:"wgs84"},t.abrupt("return",new Promise(function(){var t=(0,r.default)((0,i.default)().mark((function t(a){return(0,i.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!n.lock){t.next=3;break}return a(!1),t.abrupt("return",!1);case 3:n.lock=!0,uni.getLocation((0,o.default)((0,o.default)({},e),{},{success:function(t){n.lock=!1,a(t)},fail:function(){var t=(0,r.default)((0,i.default)().mark((function t(e){return(0,i.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:uni.showToast({title:"定位获取失败",icon:"none"}),console.error(e),a(!1);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}]),t}(),d=c;e.default=d},f403:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){}));var a=function(){var t=this.$createElement,e=this._self._c||t;return e("v-uni-view",{staticClass:"uni-status-bar",style:{height:this.statusBarHeight}},[this._t("default")],2)},i=[]}}]);