(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-uni-stat-user-overview-overview"],{"0064":function(t,e,a){"use strict";a.r(e);var i=a("0772"),n=a("fb21");for(var r in n)["default"].indexOf(r)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(r);a("2ed6");var s=a("828b"),o=Object(s["a"])(n["default"],i["b"],i["c"],!1,null,"1cbb1150",null,!1,i["a"],void 0);e["default"]=o.exports},"02a5":function(t,e,a){"use strict";var i=a("a4f6"),n=a.n(i);n.a},"0772":function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return r})),a.d(e,"a",(function(){return i}));var i={uniTooltip:a("3de2").default,uniIcons:a("937d").default},n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"uni-stat--sum-x mb-m"},t._l(t.items,(function(e,i){return a("v-uni-view",{key:i,staticClass:"uni-stat--sum-item",class:["今天"===e.value?"uni-stat--sum-item-width":""]},[a("uni-tooltip",{scopedSlots:t._u([e.tooltip?{key:"content",fn:function(){return[a("v-uni-view",{staticClass:"uni-stat-tooltip-s"},[t._v(t._s(e.tooltip))])]},proxy:!0}:null],null,!0)},[a("v-uni-view",{staticClass:"uni-stat--sum-item-title"},[t._v(t._s(e.title?e.title:"")),e.title?a("uni-icons",{staticClass:"ml-s",attrs:{type:"help",color:"#666"}}):t._e()],1)],1),a("v-uni-view",{staticClass:"uni-stat--sum-item-value"},[t._v(t._s(e.value?e.value:0))]),t.contrast?a("v-uni-view",{staticClass:"uni-stat--sum-item-contrast"},[t._v(t._s(e.contrast?e.contrast:0))]):t._e()],1)})),1)},r=[]},"15dd":function(t,e,a){"use strict";a.r(e);var i=a("7d14"),n=a.n(i);for(var r in i)["default"].indexOf(r)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(r);e["default"]=n.a},"2b68":function(t,e,a){"use strict";a.r(e);var i=a("fa25"),n=a("15dd");for(var r in n)["default"].indexOf(r)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(r);a("02a5");var s=a("828b"),o=Object(s["a"])(n["default"],i["b"],i["c"],!1,null,"ebe72f5a",null,!1,i["a"],void 0);e["default"]=o.exports},"2ed6":function(t,e,a){"use strict";var i=a("a198"),n=a.n(i);n.a},"7d14":function(t,e,a){"use strict";(function(t){a("6a54");var i=a("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(a("3471")),r=i(a("5de6"));a("8f71"),a("bf0f"),a("2797"),a("aa9c"),a("aa77"),a("fd3c"),a("d4b5"),a("c223"),a("64aa");var s=a("7af3"),o=a("cc7d"),u=o.fieldsMap.filter((function(t){return t.hasOwnProperty("value")})),l={data:function(){return{tableName:"uni-stat-result",fieldsMap:o.fieldsMap,resFieldsMap:o.resFieldsMap,entFieldsMap:o.entFieldsMap,query:{dimension:"hour",appid:"",platform_id:"",uni_platform:"",version_id:"",start_time:[]},options:{pageCurrent:1,total:0,pageSizeIndex:0,pageSizeRange:[10,20,50,100]},loading:!1,currentDateTab:2,chartTab:"new_user_count",tableData:[],resTableData:[],entTableData:[],panelData:u,chartData:{},eopts:{seriesTemplate:[{itemStyle:{borderWidth:2,borderColor:"#1890FF",color:"#1890FF"},areaStyle:{color:{colorStops:[{offset:0,color:"#1890FF"},{offset:1,color:"#FFFFFF"}]}}},{lineStyle:{color:"#ea7ccc",width:2,type:"dashed"},itemStyle:{borderWidth:1,borderColor:"#ea7ccc",color:"#ea7ccc"},areaStyle:null}]},tabIndex:0,errorMessage:""}},onLoad:function(t){var e=t.appid;e&&(this.query.appid=e)},computed:{pageSize:function(){var t=this.options,e=t.pageSizeRange,a=t.pageSizeIndex;return e[a]},chartTabs:function(){var t=[];return o.fieldsMap.forEach((function(e){var a=e.field,i=e.title;a&&i&&t.push({_id:a,name:i})})),t},versionQuery:function(){var t=this.query,e=t.appid,a=t.uni_platform,i=(0,s.stringifyQuery)({appid:e,uni_platform:a});return i},channelQuery:function(){var t=this.query,e=t.appid,a=t.platform_id,i=(0,s.stringifyQuery)({appid:e,platform_id:a});return i}},created:function(){var t=this;this.debounceGet=(0,s.debounce)((function(){t.getAllData(t.query)}),300)},watch:{query:{deep:!0,handler:function(t){this.options.pageCurrent=1,this.debounceGet()}}},methods:{useDatetimePicker:function(){this.currentDateTab=null},changePlatform:function(t,e,a,i){this.query.version_id=0,this.query.uni_platform=i.code},changeTimeRange:function(t,e){this.currentDateTab=e;var a,i;a=(0,s.getTimeOfSomeDayAgo)(t),i=t?(0,s.getTimeOfSomeDayAgo)(0)-1:(0,s.getTimeOfSomeDayAgo)(0)+864e5-1,this.query.start_time=[a,i]},changePageCurrent:function(t){this.options.pageCurrent=t.current,this.getChartData(this.query)},changePageSize:function(t){var e=t.detail.value;this.options.pageCurrent=1,this.options.pageSizeIndex=e,this.getChartData(this.query)},changeChartTab:function(t,e,a){this.tabIndex=e,this.getChartData(this.query,t,a)},getAllData:function(t){t.appid?(this.errorMessage="",this.getPanelData(),this.getChartData(t)):this.errorMessage="请先选择应用"},getDays:function(){if(!this.query.start_time.length)return!0;var t=(0,r.default)(this.query.start_time,2),e=t[0],a=t[1],i=a-e>=864e5;return i},getPanelData:function(){var e=this,a=this.query,i=a.appid,n=a.platform_id,r=a.version_id,u=(0,s.stringifyQuery)({appid:i,platform_id:n,version_id:r,start_time:[(0,s.getTimeOfSomeDayAgo)(1),(new Date).getTime()]}),l=t.database();l.collection(this.tableName).where(u).field("".concat((0,s.stringifyField)(o.fieldsMap),",dimension,stat_date")).groupBy("stat_date, dimension").groupField((0,s.stringifyGroupField)(o.fieldsMap)).orderBy("stat_date","desc").get().then((function(t){var a=t.result.data,i=a.find((function(t){return t.stat_date===(0,s.parseDateTime)((0,s.getTimeOfSomeDayAgo)(0),"","")}))||{};i.total_users=0;var n=a.find((function(t){return"day"===t.dimension&&t.stat_date===(0,s.parseDateTime)((0,s.getTimeOfSomeDayAgo)(1),"","")}));e.panelData=[],e.panelData=(0,s.mapfields)(o.fieldsMap,i),e.panelData.map((function(t){(0,s.mapfields)(o.fieldsMap,n,t,"","contrast")})),s.getFieldTotal.call(e,u,"total_users")}))},getChartData:function(e){var a,i=this,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.chartTabs[this.tabIndex]._id,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.chartTabs[this.tabIndex].name,c=(this.options.pageCurrent,this.currentDateTab),d=(0,s.getTimeOfSomeDayAgo)(c),f=864e5;if(!this.getDays()){var p=d-f,v=d+f-1;e=JSON.parse(JSON.stringify(e)),a=e.start_time=[p,v]}e=(0,s.stringifyQuery)(e,!0,["uni_platform"]);var m=t.database();m.collection(this.tableName).where(e).field("".concat((0,s.stringifyField)(o.fieldsMap,u),", start_time")).groupBy("start_time").groupField((0,s.stringifyGroupField)(o.fieldsMap,u)).orderBy("start_time","asc").get({getCount:!0}).then((function(t){var e=t.result,c=(e.count,e.data),f={categories:[],series:[{name:l,data:[]}]},p=o.fieldsMap.filter((function(t){return t.field===u}));if(p=JSON.parse(JSON.stringify(p)),delete p[0].value,p[0].formatter="",i.getDays()){var v,m=(0,n.default)(c);try{for(m.s();!(v=m.n()).done;){var h=v.value;(0,s.mapfields)(p,h,h);var b=(0,s.formatDate)(h.start_time,"day"),g=Number(h[u]);f.series[0].data.push(g),f.categories.push(b)}}catch(y){m.e(y)}finally{m.f()}}else(function(){for(var t=a,e=(0,r.default)(t,2),i=e[0],n=e[1],o=f.series[1]={name:(0,s.formatDate)(i),data:[]},l=f.series[0]={name:(0,s.formatDate)(n),data:[]},v=function(t){var e=t<10?"0"+t:t,a="".concat(e,":00 ~ ").concat(e,":59");f.categories.push(a),o.data[t]=0,l.data[t]=0,c.forEach((function(e){(0,s.mapfields)(p,e,e);var a=Number(e[u]),i=new Date(e.start_time);e.start_time<d?i.getHours()===t&&(o.data[t]=a):i.getHours()===t&&(l.data[t]=a)}))},m=0;m<24;++m)v(m)})();i.chartData=f})).catch((function(t){})).finally((function(){}))},getAppAccessTimes:function(e){var a=t.database();return a.collection(this.tableName).where(e).groupBy("appid").groupField("sum(page_visit_count) as total_app_access").get()},navTo:function(t){t&&uni.navigateTo({url:t})}}};e.default=l}).call(this,a("861b")["default"])},9954:function(t,e,a){var i=a("c86c");e=i(!1),e.push([t.i,".uni-stat-card-header[data-v-ebe72f5a]{display:flex;justify-content:space-between;color:#555;font-size:14px;font-weight:600;padding:10px 0;margin-bottom:15px}.uni-stat-card-header-link[data-v-ebe72f5a]{cursor:pointer}",""]),t.exports=e},a198:function(t,e,a){var i=a("baa1");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=a("967d").default;n("b6fe76f6",i,!0,{sourceMap:!1,shadowMode:!1})},a4f6:function(t,e,a){var i=a("9954");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=a("967d").default;n("04bf97f3",i,!0,{sourceMap:!1,shadowMode:!1})},baa1:function(t,e,a){var i=a("c86c");e=i(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 水平间距 */\r\n/* 水平间距 */\r\n/* 行为相关颜色 */\r\n/* 兼容 uni-ui 相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.uni-stat-tooltip-s[data-v-1cbb1150]{width:160px;white-space:normal}.uni-stat--sum-x[data-v-1cbb1150]{display:flex;justify-content:space-evenly;flex-wrap:wrap;border-radius:4px;padding:15px;box-shadow:-1px -1px 5px 0 rgba(0,0,0,.1)}.uni-stat--sum-item[data-v-1cbb1150]{white-space:nowrap;text-align:center;margin:10px 18px}.uni-stat--sum-item-width[data-v-1cbb1150]{width:100px}.uni-stat--sum-item-title[data-v-1cbb1150]{display:flex;align-items:center;justify-content:center;min-height:17px;font-size:12px;color:#666}.uni-stat--sum-item-value[data-v-1cbb1150]{font-size:24px;line-height:48px;font-weight:700;color:#333}.uni-stat--sum-item-contrast[data-v-1cbb1150]{font-size:14px;color:#666}@media screen and (max-width:500px){.uni-stat--sum-x[data-v-1cbb1150]{padding:15px 0;justify-content:space-between;flex-wrap:unset;overflow-x:auto!important}[data-v-1cbb1150]::-webkit-scrollbar{display:none}}',""]),t.exports=e},cc7d:function(t,e,a){"use strict";a("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.resFieldsMap=e.fieldsMap=e.entFieldsMap=void 0;e.fieldsMap=[{value:"今天",contrast:"昨天"},{title:"新增用户",field:"new_user_count",tooltip:"首次访问应用的用户数（以用户为判断标准，去重）",value:0,contrast:0},{title:"活跃用户",field:"active_user_count",tooltip:"访问过应用内任意页面的总用户数，今日数据为每小时活跃用户累加（未虑重），昨日数据为全天活跃用户虑重后结果。",value:0,contrast:0},{title:"次均停留时长",field:"avg_user_session_time",formatter:":",tooltip:"平均每次打开应用停留在应用内的总时长，即应用停留总时长/启动次数",value:0,contrast:0,stat:"avg"},{title:"人均停留时长 ",field:"avg_user_time",formatter:":",tooltip:"平均每个用户停留在应用内的总时长，即应用停留总时长/活跃用户",value:0,contrast:0,stat:"avg"},{title:"总用户数",field:"total_users",tooltip:"从添加统计到当前选择时间的总用户数（去重）",value:0,contrast:0}];e.resFieldsMap=[{title:"受访页",field:"path",tooltip:"用户进入应用访问的所有页面，例如用户从页面1进入应用，跳转到页面2，1,2均为受访页",formatter:""},{title:"访问次数",field:"visit_times",tooltip:"访问该页面的总次数",value:0},{title:"占比",field:"rate",computed:"visit_times/total_app_access",tooltip:"某个页面的访问次数占所有页面访问次数的比例",formatter:"%"}];e.entFieldsMap=[{title:"入口页",field:"path",tooltip:"用户进入应用访问的第一个页面，例如用户从页面1进入应用，跳转到页面2，1为入口页，而2不是",formatter:""},{title:"访问次数",field:"entry_count",tooltip:"访问该页面的总次数",value:0},{title:"占比",field:"rate",computed:"entry_count/total_app_access",tooltip:"某个页面的访问次数占所有页面访问次数的比例",formatter:"%"}]},dc00:function(t,e,a){"use strict";a("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={name:"uni-stat-panel",data:function(){return{}},props:{items:{type:Array,default:function(){return[]}},contrast:{type:Boolean,default:!1}}};e.default=i},fa25:function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return r})),a.d(e,"a",(function(){return i}));var i={uniStatBreadcrumb:a("d84b").default,uniDataSelect:a("2614").default,uniStatTabs:a("00f4").default,uniDatetimePicker:a("3f54").default,uniStatPanel:a("0064").default,qiunDataCharts:a("82f9").default},n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"fix-top-window"},[a("v-uni-view",{staticClass:"uni-header"},[a("uni-stat-breadcrumb",{staticClass:"uni-stat-breadcrumb-on-phone"})],1),a("v-uni-view",{staticClass:"uni-container"},[a("v-uni-view",{staticClass:"uni-stat--x flex p-1015"},[a("v-uni-view",{staticClass:"uni-stat--app-select"},[a("uni-data-select",{attrs:{collection:"opendb-app-list",field:"appid as value, name as text",orderby:"text asc",defItem:1,label:"应用选择",clear:!1},model:{value:t.query.appid,callback:function(e){t.$set(t.query,"appid",e)},expression:"query.appid"}}),a("uni-data-select",{staticClass:"ml-m",attrs:{collection:"opendb-app-versions",where:t.versionQuery,field:"_id as value, version as text, uni_platform as label, create_date as date",format:"{label} - {text}",orderby:"date desc",label:"版本选择"},model:{value:t.query.version_id,callback:function(e){t.$set(t.query,"version_id",e)},expression:"query.version_id"}})],1)],1),a("v-uni-view",{staticClass:"uni-stat--x flex"},[a("uni-stat-tabs",{attrs:{label:"日期选择",current:t.currentDateTab,mode:"date",today:!0},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.changeTimeRange.apply(void 0,arguments)}}}),a("uni-datetime-picker",{staticClass:"uni-stat-datetime-picker",class:{"uni-stat__actived":t.currentDateTab<0&&!!t.query.start_time.length},attrs:{type:"datetimerange",end:(new Date).getTime(),returnType:"timestamp",clearIcon:!1},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.useDatetimePicker.apply(void 0,arguments)}},model:{value:t.query.start_time,callback:function(e){t.$set(t.query,"start_time",e)},expression:"query.start_time"}})],1),a("v-uni-view",{staticClass:"uni-stat--x"},[a("uni-stat-tabs",{attrs:{label:"平台选择",type:"boldLine",mode:"platform"},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.changePlatform.apply(void 0,arguments)}},model:{value:t.query.platform_id,callback:function(e){t.$set(t.query,"platform_id",e)},expression:"query.platform_id"}}),t.query.platform_id&&-1===t.query.platform_id.indexOf("==")?a("uni-data-select",{ref:"version-select",staticClass:"p-channel",attrs:{collection:"uni-stat-app-channels",where:t.channelQuery,field:"_id as value, channel_name as text",orderby:"text asc",label:"渠道/场景值选择"},model:{value:t.query.channel_id,callback:function(e){t.$set(t.query,"channel_id",e)},expression:"query.channel_id"}}):t._e()],1),a("uni-stat-panel",{attrs:{items:t.panelData,contrast:!0}}),a("v-uni-view",{staticClass:"uni-stat--x p-m"},[a("v-uni-view",{staticClass:"uni-stat-card-header"},[t._v("趋势图")]),a("uni-stat-tabs",{staticClass:"mb-l",attrs:{type:"box",tabs:t.chartTabs},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.changeChartTab.apply(void 0,arguments)}},model:{value:t.chartTab,callback:function(e){t.chartTab=e},expression:"chartTab"}}),a("v-uni-view",{staticClass:"uni-charts-box"},[a("qiun-data-charts",{attrs:{type:"area",chartData:t.chartData,eopts:t.eopts,echartsH5:!0,echartsApp:!0,tooltipFormat:"tooltipCustom",errorMessage:t.errorMessage}})],1)],1)],1)],1)},r=[]},fb21:function(t,e,a){"use strict";a.r(e);var i=a("dc00"),n=a.n(i);for(var r in i)["default"].indexOf(r)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(r);e["default"]=n.a}}]);