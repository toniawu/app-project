(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-Push_rules-add"],{"66ed":function(e,t,a){"use strict";a.r(t);var r=a("96b5"),n=a("7768");for(var u in n)["default"].indexOf(u)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(u);var i=a("828b"),l=Object(i["a"])(n["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],void 0);t["default"]=l.exports},"6e15":function(e,t,a){"use strict";a("6a54");var r=a("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.enumConverter=void 0,t.filterToWhere=function(e,t){var a={};for(var r in e){var i=e[r],l=i.type,s=i.value;switch(l){case"search":"string"===typeof s&&s.length&&(a[r]=new RegExp(s));break;case"select":if(s.length){var o,f=[],c=(0,u.default)(s);try{for(c.s();!(o=c.n()).done;){var m=o.value;f.push(t.eq(m))}}catch(g){c.e(g)}finally{c.f()}a[r]=t.or(f)}break;case"range":if(s.length){var d=s[0],v=s[1];a[r]=t.and([t.gte(d),t.lte(v)])}break;case"date":if(s.length){var p=(0,n.default)(s,2),b=p[0],h=p[1],x=new Date(b),D=new Date(h);a[r]=t.and([t.gte(x),t.lte(D)])}break;case"timestamp":if(s.length){var y=(0,n.default)(s,2),k=y[0],_=y[1];a[r]=t.and([t.gte(k),t.lte(_)])}break}}return a},t.validator=void 0;var n=r(a("5de6")),u=r(a("3471"));a("23f4"),a("7d2f"),a("5c47"),a("9c4e"),a("ab80"),a("aa9c");t.validator={serial:{rules:[{required:!0},{format:"int"}],title:"序号",label:"序号"},surveyNum:{rules:[{format:"int"}],title:"问卷序号",label:"问卷序号"},survey_id:{rules:[{required:!0},{format:"string"}],title:"关联问卷",label:"关联问卷"},videoNum:{rules:[{required:!0},{format:"int"}],title:"视频序号",label:"视频序号"},video_id:{rules:[{required:!0},{format:"string"}],title:"关联视频",label:"关联视频"},questions:{rules:[{format:"array"}],title:"关联问题",label:"关联问题"},pushDate:{rules:[{required:!0},{format:"timestamp"}],title:"推送日期",label:"推送日期"},min_score:{rules:[{format:"int"}],title:"最低分数",label:"最低分数"},max_score:{rules:[{format:"int"}],title:"最高分数",label:"最高分数"},pushWeek:{rules:[{required:!0},{format:"int"},{range:[{value:1,text:1},{value:2,text:2},{value:3,text:3},{value:4,text:4},{value:5,text:5},{value:6,text:6},{value:7,text:7},{value:8,text:8},{value:9,text:9},{value:10,text:10},{value:11,text:11},{value:12,text:12}]}],title:"答题后第N周",label:"答题后第N周"}};t.enumConverter={pushWeek_valuetotext:{1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,11:11,12:12}}},7768:function(e,t,a){"use strict";a.r(t);var r=a("9b91"),n=a.n(r);for(var u in r)["default"].indexOf(u)<0&&function(e){a.d(t,e,(function(){return r[e]}))}(u);t["default"]=n.a},"96b5":function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return u})),a.d(t,"a",(function(){return r}));var r={uniForms:a("6d6e").default,uniFormsItem:a("1e91").default,uniEasyinput:a("f400").default,uniDataPicker:a("77de").default,uniDataCheckbox:a("6108").default,uniDatetimePicker:a("3f54").default},n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"uni-container"},[a("uni-forms",{ref:"form",attrs:{model:e.formData,validateTrigger:"bind"}},[a("uni-forms-item",{attrs:{name:"serial",label:"序号",required:!0}},[a("uni-easyinput",{attrs:{type:"number"},model:{value:e.formData.serial,callback:function(t){e.$set(e.formData,"serial",t)},expression:"formData.serial"}})],1),a("uni-forms-item",{attrs:{name:"surveyNum",label:"问卷序号"}},[a("uni-easyinput",{attrs:{type:"number"},model:{value:e.formData.surveyNum,callback:function(t){e.$set(e.formData,"surveyNum",t)},expression:"formData.surveyNum"}})],1),a("uni-forms-item",{attrs:{name:"survey_id",label:"关联问卷",required:!0}},[a("uni-data-picker",{attrs:{collection:"Surveys",field:"_id as value, title as text"},model:{value:e.formData.survey_id,callback:function(t){e.$set(e.formData,"survey_id",t)},expression:"formData.survey_id"}})],1),a("uni-forms-item",{attrs:{name:"videoNum",label:"视频序号",required:!0}},[a("uni-easyinput",{attrs:{type:"number"},model:{value:e.formData.videoNum,callback:function(t){e.$set(e.formData,"videoNum",t)},expression:"formData.videoNum"}})],1),a("uni-forms-item",{attrs:{name:"video_id",label:"关联视频",required:!0}},[a("uni-data-picker",{attrs:{collection:"Videos",field:"_id as value, title as text"},model:{value:e.formData.video_id,callback:function(t){e.$set(e.formData,"video_id",t)},expression:"formData.video_id"}})],1),a("uni-forms-item",{attrs:{name:"questions",label:"关联问题"}},[a("uni-data-checkbox",{attrs:{multiple:!0,max:"10",localdata:e.range},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.change.apply(void 0,arguments)}},model:{value:e.formData.questions,callback:function(t){e.$set(e.formData,"questions",t)},expression:"formData.questions"}})],1),a("uni-forms-item",{attrs:{name:"pushDate",label:"推送日期",required:!0}},[a("uni-datetime-picker",{attrs:{"return-type":"timestamp"},model:{value:e.formData.pushDate,callback:function(t){e.$set(e.formData,"pushDate",t)},expression:"formData.pushDate"}})],1),a("uni-forms-item",{attrs:{name:"min_score",label:"最低分数"}},[a("uni-easyinput",{attrs:{type:"number"},model:{value:e.formData.min_score,callback:function(t){e.$set(e.formData,"min_score",t)},expression:"formData.min_score"}})],1),a("uni-forms-item",{attrs:{name:"max_score",label:"最高分数"}},[a("uni-easyinput",{attrs:{type:"number"},model:{value:e.formData.max_score,callback:function(t){e.$set(e.formData,"max_score",t)},expression:"formData.max_score"}})],1),a("uni-forms-item",{attrs:{name:"pushWeek",label:"答题后第N周",required:!0}},[a("uni-data-checkbox",{attrs:{localdata:e.formOptions.pushWeek_localdata},model:{value:e.formData.pushWeek,callback:function(t){e.$set(e.formData,"pushWeek",t)},expression:"formData.pushWeek"}})],1),a("v-uni-view",{staticClass:"uni-button-group"},[a("v-uni-button",{staticClass:"uni-button",staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.submit.apply(void 0,arguments)}}},[e._v("提交")]),a("v-uni-navigator",{staticStyle:{"margin-left":"15px"},attrs:{"open-type":"navigateBack"}},[a("v-uni-button",{staticClass:"uni-button",staticStyle:{width:"100px"}},[e._v("返回")])],1)],1)],1)],1)},u=[]},"9b91":function(e,t,a){"use strict";(function(e){a("6a54");var r=a("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a("2634")),u=r(a("2fdc")),i=r(a("9b1b"));a("4626"),a("5ac7"),a("dc8a"),a("fd3c"),a("bf0f");var l=a("6e15"),s=e.database();s.command;function o(e){var t={};for(var a in l.validator)e.includes(a)&&(t[a]=l.validator[a]);return t}var f={data:function(){var e={serial:null,surveyNum:null,survey_id:"",videoNum:null,video_id:"",questions:[],pushDate:null,min_score:null,max_score:null,pushWeek:null};return{formData:e,formOptions:{pushWeek_localdata:[{value:1,text:1},{value:2,text:2},{value:3,text:3},{value:4,text:4},{value:5,text:5},{value:6,text:6},{value:7,text:7},{value:8,text:8},{value:9,text:9},{value:10,text:10},{value:11,text:11},{value:12,text:12}]},rules:(0,i.default)({},o(Object.keys(e))),range:[]}},onReady:function(){this.$refs.form.setRules(this.rules),this.getQuestions()},methods:{change:function(e){},getQuestions:function(){var e=this;return(0,u.default)((0,n.default)().mark((function t(){var a;return(0,n.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,s.collection("Questions").get();case 2:a=t.sent,e.range=a.result.data.map((function(e){return{value:e._id,text:e.title}}));case 5:case"end":return t.stop()}}),t)})))()},submit:function(){var e=this;uni.showLoading({mask:!0}),this.$refs.form.validate().then((function(t){return e.submitForm(t)})).catch((function(){})).finally((function(){uni.hideLoading()}))},submitForm:function(e){var t=this;return s.collection("Push_rules").add(e).then((function(e){uni.showToast({title:"新增成功"}),t.getOpenerEventChannel().emit("refreshData"),setTimeout((function(){return uni.navigateBack()}),500)})).catch((function(e){uni.showModal({content:e.message||"请求服务失败",showCancel:!1})}))}}};t.default=f}).call(this,a("861b")["default"])}}]);